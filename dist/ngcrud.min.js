!function(e){var t=e.module("CrudModule");t.controller("listCtrl",["$scope",function(e){e.checkAll=function(){this.records.forEach(function(e){e.selected=!e.selected})}}]),t.controller("datePickerCtrl",["$scope",function(e){e.today=function(){e.value=new Date},e.clear=function(){e.value=null},e.open=function(t){t.preventDefault(),t.stopPropagation(),e.opened=!0}}]),t.controller("modalCtrl",["$scope","$modalInstance","items","name","currentItems",function(t,n,r,o,c){function i(t,n){e.forEach(n,function(n){e.forEach(t,function(e){e.id===n.id&&(e.selected=!0)})})}function s(){return t.items.filter(function(e){return!!e.selected})}t.model=[{name:"name",displayName:"Name",type:"String",order:1}],t.name=o,t.items=r,i(r,c),t.ok=function(){n.close(s())},t.cancel=function(){n.dismiss("cancel")}}])}(window.angular),function(e){var t=e.module("CrudModule");t.directive("searchBar",[function(){return{scope:{name:"=",model:"=*",record:"=",submitFn:"&"},restrict:"E",templateUrl:"src/shared/crud/search.tpl.html"}}]),t.directive("listRecords",[function(){return{scope:{records:"=*",model:"=*",actions:"=*?",checklist:"=?"},restrict:"E",templateUrl:"src/shared/crud/list.tpl.html",controller:"listCtrl"}}]),t.directive("gallery",[function(){return{scope:{records:"=*",model:"=*",actions:"=*?",checklist:"=?"},restrict:"E",templateUrl:"src/shared/crud/gallery.tpl.html"}}]),t.directive("toolbar",[function(){return{scope:{actions:"=*",name:"=",displayName:"="},restrict:"E",templateUrl:"src/shared/crud/toolbar.tpl.html"}}]),t.directive("crudForm",[function(){return{scope:{name:"=",model:"=*",record:"="},restrict:"E",templateUrl:"src/shared/crud/form.tpl.html"}}]),t.directive("datePicker",[function(){return{scope:{model:"=",value:"="},restrict:"E",templateUrl:"src/shared/crud/datepicker.tpl.html",controller:"datePickerCtrl"}}])}(window.angular),function(e){var t=e.module("CrudModule",["restangular","ui.bootstrap"]);t.config(["RestangularProvider",function(e){e.setBaseUrl("webresources"),e.addRequestInterceptor(function(e,t){return"remove"===t?null:e}),e.addResponseInterceptor(function(e,t,n,r,o){return"getList"===t&&o.headers("X-Total-Count")&&(e.totalRecords=parseInt(o.headers("X-Total-Count"))),e})}])}(window.angular),function(e){var t=e.module("CrudModule");t.service("actionsService",[function(){this.buildGlobalActions=function(e){return[{name:"create",displayName:"Create",icon:"plus",fn:function(){e.createRecord()},show:function(){return!e.readOnly&&!e.editMode}},{name:"refresh",displayName:"Refresh",icon:"refresh",fn:function(){e.fetchRecords()},show:function(){return!e.editMode}},{name:"save",displayName:"Save",icon:"save",fn:function(){e.saveRecord()},show:function(){return!e.readOnly&&e.editMode}},{name:"cancel",displayName:"Cancel",icon:"remove",fn:function(){e.fetchRecords()},show:function(){return!e.readOnly&&e.editMode}}]},this.buildRecordActions=function(e){return[{name:"edit",displayName:"Edit",icon:"edit",fn:function(t){e.editRecord(t)},show:function(){return!e.readOnly}},{name:"delete",displayName:"Delete",icon:"minus",fn:function(t){e.deleteRecord(t)},show:function(){return!e.readOnly}}]}}]),t.service("CRUDBase",["Restangular","actionsService","$injector",function(e,t,n){function r(e,r,o,c){function i(t,n){var r=["info","danger","warning","success"];r.some(function(e){return n===e})&&e.alerts.push({type:n,msg:t})}e.name=o,e.displayName=c,e.model=r,e.currentRecord={},e.records=[],e.alerts=[],this.maxSize=5,this.itemsPerPage=10,this.totalItems=0,this.currentPage=1,this.numPages=0,this.pageChanged=function(){this.fetchRecords()},this.readOnly=!1,this.editMode=!1,this.showError=function(e){i(e,"danger")},this.showSuccess=function(e){i(e,"success")},this.showWarning=function(e){i(e,"warning")},this.showInfo=function(e){i(e,"info")},this.closeAlert=function(t){e.alerts.splice(t,1)},this.loadRefOptions=function(){function t(e){var t=n.get(e.service);t.fetchRecords().then(function(t){e.options=t.plain(),e.required||e.options.unshift(null)})}var r=e.model;for(var o in r)if(r.hasOwnProperty(o)){var c=r[o];"Reference"===c.type&&c.service&&n.has(c.service)&&t(c)}},this.globalActions=t.buildGlobalActions(this),this.recordActions=t.buildRecordActions(this)}function o(e,t,n,o,c){function i(e){s.showError(e.data)}r.call(this,e,t,o,c);var s=this;this.createRecord=function(){this.editMode=!0,e.currentRecord={}},this.editRecord=function(t){return n.fetchRecord(t).then(function(t){return e.currentRecord=t,s.editMode=!0,t},i)},this.fetchRecords=function(){return n.fetchRecords(this.currentPage,this.itemsPerPage).then(function(t){return e.records=t,s.totalItems=t.totalRecords,e.currentRecord={},s.editMode=!1,t},i)},this.saveRecord=function(){return n.saveRecord(e.currentRecord).then(function(){s.fetchRecords()},i)},this.deleteRecord=function(e){return n.deleteRecord(e).then(function(){s.fetchRecords()},i)}}function c(t){this.url=t,this.api=e.all(this.url),this.fetchRecords=function(e,t){return this.api.getList({page:e,maxRecords:t})},this.fetchRecord=function(e){return e.get()},this.saveRecord=function(e){return e.id?e.put():this.api.post(e)},this.deleteRecord=function(e){return e.remove()},this.extendController=function(e,t,n,r,c){o.call(e,t,n,this,r,c)}}this.extendCommonController=function(e,t,n,o,c){r.call(e,t,n,o,c)},this.extendService=function(e,t){c.call(e,t)}}]),t.service("modalService",["$modal",function(e){this.createSelectionModal=function(t,n,r){return e.open({animation:!0,templateUrl:"src/shared/crud/modal.tpl.html",controller:"modalCtrl",resolve:{name:function(){return t},items:function(){return n},currentItems:function(){return r}}})}}])}(window.angular);
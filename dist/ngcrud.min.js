/*! ng-crud Universidad de Los Andes */
!function(a){var b=a.module("ngCrud",["restangular","ui.bootstrap"]),c="src/crud/templates/";b.constant("CrudTemplatesDir",c),b.constant("CrudTemplateURL",c+"crud.tpl.html"),b.constant("CrudCtrlAlias","ctrl"),b.config(["RestangularProvider",function(a){a.addRequestInterceptor(function(a,b){return"remove"===b?null:a}),a.addResponseInterceptor(function(a,b,c,d,e){return"getList"===b&&e.headers("X-Total-Count")&&(a.totalRecords=parseInt(e.headers("X-Total-Count"))),a})}])}(window.angular),function(a){var b=a.module("ngCrudMock",["ngMockE2E"]);b.provider("MockConfig",[function(){var b={baseUrl:"api"};this.setConfig=function(c){return c&&(b=a.extend(b,c)),b},this.$get=[function(){return b}]}]),b.value("ngCrudMock.mockRecords",{}),b.run(["$httpBackend","ngCrudMock.mockRecords","MockConfig",function(b,c,d){function e(a){for(var b,c={},d=a.slice(a.indexOf("?")+1).split("&"),e=0;e<d.length;e++)b=d[e].split("="),c[b[0]]=b[1];return c}function f(a){var b=a.split("?")[0],c=new RegExp(h+"/"),d=b.split(c).pop();return d.split("/")[0]}function g(a){var b=f(a);return void 0===c[b]&&(c[b]=[]),c[b]}var h=d.baseUrl,i="(([?](\\w+=\\w+))([&](\\w+=\\w+))*)?$",j=new RegExp(h+"/(\\w+)"+i),k=new RegExp(h+"/(\\w+)/([0-9]+)"+i),l=new RegExp("^((?!"+h+").)*$");b.whenGET(l).passThrough(),b.whenGET(j).respond(function(a,b){var c=g(b),d=[],f=e(b),h=f.page,i=f.maxRecords,j={};if(h&&i){var k=(h-1)*i,l=k+i;d=c.slice(k,l),j={"X-Total-Count":c.length}}else d=c;return[200,d,j]}),b.whenGET(k).respond(function(b,c){var d,e=g(c),f=parseInt(c.split("/").pop());return a.forEach(e,function(b){b.id===f&&(d=a.copy(b))}),[200,d,{}]}),b.whenPOST(j).respond(function(b,c,d){var e=g(c),f=a.fromJson(d);return f.id=Math.floor(1e4*Math.random()),e.push(f),[201,f,{}]}),b.whenPUT(k).respond(function(b,c,d){var e=g(c),f=a.fromJson(d);return a.forEach(e,function(a,b){a.id===f.id&&e.splice(b,1,f)}),[200,null,{}]}),b.whenDELETE(k).respond(function(b,c){var d=g(c),e=parseInt(c.split("/").pop());return a.forEach(d,function(a,b){a.id===e&&d.splice(b,1)}),[204,null,{}]})}])}(window.angular),function(a){var b=a.module("ngCrud");b.controller("listCtrl",["$scope",function(a){a.checkAll=function(){this.records.forEach(function(a){a.selected=!a.selected})}}]),b.controller("datePickerCtrl",["$scope",function(a){a.today=function(){a.value=new Date},a.clear=function(){a.value=null},a.open=function(b){b.preventDefault(),b.stopPropagation(),a.opened=!0}}]),b.controller("modalCtrl",["$scope","$modalInstance","items","name","currentItems",function(b,c,d,e,f){function g(b,c){a.forEach(c,function(c){a.forEach(b,function(a){a.id===c.id&&(a.selected=!0)})})}function h(){return b.items.filter(function(a){return!!a.selected})}b.fields=[{name:"name",displayName:"Name",type:"String"}],b.name=e,b.items=d.plain();var i=this;b.recordActions={add:{displayName:"Add",icon:"plus",fn:function(a){a.selected=!0,f.customPOST(a,a.id)},show:function(a){return!i.readOnly&&!a.selected}}},g(b.items,f),b.ok=function(){c.close(h())},b.cancel=function(){c.dismiss("cancel")}}])}(window.angular),function(a){var b=a.module("ngCrud");b.directive("searchBar",["CrudTemplatesDir",function(a){return{scope:{name:"=",fields:"=*",record:"=",submitFn:"&"},restrict:"E",templateUrl:a+"search.tpl.html"}}]),b.directive("listRecords",["CrudTemplatesDir",function(a){return{scope:{records:"=*",fields:"=*",actions:"=*?",checklist:"=?"},restrict:"E",templateUrl:a+"list.tpl.html",controller:"listCtrl"}}]),b.directive("gallery",["CrudTemplatesDir",function(a){return{scope:{records:"=*",fields:"=*",actions:"=*?",checklist:"=?"},restrict:"E",templateUrl:a+"gallery.tpl.html"}}]),b.directive("toolbar",["CrudTemplatesDir",function(a){return{scope:{actions:"=*",name:"=",displayName:"="},restrict:"E",templateUrl:a+"toolbar.tpl.html"}}]),b.directive("crudForm",["CrudTemplatesDir",function(a){return{scope:{name:"=",fields:"=*",record:"="},restrict:"E",templateUrl:a+"form.tpl.html"}}]),b.directive("datePicker",["CrudTemplatesDir",function(a){return{scope:{model:"=",value:"="},restrict:"E",templateUrl:a+"datepicker.tpl.html",controller:"datePickerCtrl"}}]),b.directive("childController",["$compile","CrudCtrlAlias",function(a,b){return{restrict:"A",terminal:!0,priority:1e5,link:function(c,d){d.removeAttr("child-controller"),c.child&&c.child.ctrl&&(d.attr("ng-controller",c.child.ctrl+" as "+b),d.attr("ng-include",c.child.template?"child.template":"ctrl.tpl"),a(d)(c))}}}])}(window.angular),function(a,b){function c(a){return{create:{displayName:"Create",icon:"plus",fn:function(){a.createRecord()},show:function(){return!a.readOnly&&!a.editMode}},refresh:{displayName:"Refresh",icon:"refresh",fn:function(){a.fetchRecords()},show:function(){return!a.editMode}},save:{displayName:"Save",icon:"save",fn:function(){a.saveRecord()},show:function(){return!a.readOnly&&a.editMode}},cancel:{displayName:"Cancel",icon:"remove",fn:function(){a.fetchRecords()},show:function(){return!a.readOnly&&a.editMode}}}}function d(a){return{edit:{displayName:"Edit",icon:"edit",fn:function(b){a.editRecord(b)},show:function(){return!a.readOnly}},"delete":{displayName:"Delete",icon:"minus",fn:function(b){a.deleteRecord(b)},show:function(){return!a.readOnly}}}}var e=a.module("ngCrud");e.service("CrudCreator",["Restangular","$injector","CrudTemplateURL","modalService","$location",function(e,f,g,h,i){function j(a,b,h,i){function j(b,c){var d=["info","danger","warning","success"];d.some(function(a){return c===a})&&a.alerts.push({type:c,msg:b})}a.name=h,a.displayName=i,a.model=b,a.currentRecord={},a.records=[],a.alerts=[],this.maxSize=5,this.itemsPerPage=10,this.totalItems=0,this.currentPage=1,this.numPages=0,this.pageChanged=function(){this.fetchRecords()},this.readOnly=!1,this.editMode=!1,this.tpl=g,this.asGallery=!1,this.showError=function(a){j(a,"danger")},this.showSuccess=function(a){j(a,"success")},this.showWarning=function(a){j(a,"warning")},this.showInfo=function(a){j(a,"info")},this.closeAlert=function(b){a.alerts.splice(b,1)},this.loadRefOptions=function(){function b(a){var b=f.get(a.url);e.all(b).getList().then(function(b){a.options=b.plain(),a.required||a.options.unshift(null)},function(a){c.showError(a.data)})}var c=this,d=a.model.fields;for(var g in d)if(d.hasOwnProperty(g)){var h=d[g];"Reference"===h.type&&h.url&&f.has(h.url)&&b(h)}},this.globalActions=c(this),this.recordActions=d(this)}function k(b,c,d,f,g){function h(a){k.showError(a.data)}j.call(this,b,c,f,g);var k=this;this.changeTab=function(a){b.tab=a},this.fetchRecords=function(){var c={page:this.currentPage,maxRecords:this.itemsPerPage};return a.extend(c,i.search()),e.all(d).getList(c).then(function(a){return b.records=a,k.totalItems=a.totalRecords,b.currentRecord={},k.editMode=!1,a},h)},this.createRecord=function(){b.$broadcast("pre-create",b.currentRecord),this.editMode=!0,b.currentRecord={},b.$broadcast("post-create",b.currentRecord)},this.editRecord=function(a){return b.$broadcast("pre-edit",a),a.get().then(function(a){return b.currentRecord=a,k.editMode=!0,b.$broadcast("post-edit",a),a},h)},this.saveRecord=function(){var a,c=b.currentRecord;a=c.id?c.put():b.records.post(c),a.then(function(){k.fetchRecords()},h)},this.deleteRecord=function(a){return a.remove().then(function(){k.fetchRecords()},h)}}function l(a,b,c,d){var e=a.currentRecord;j.call(this,a,{fields:b.fields},c,d),e&&(void 0===e[c]&&(e[c]=[]),a.records=e[c],a.refId=e.id)}function m(c,d,e,f,g){function h(a){var b=void 0!==a.id?"id":"cid";for(var d in c.records)if(c.records.hasOwnProperty(d)){var e=c.records[d];if(e[b]===a[b])return d}}l.call(this,c,d,e,f),c.parent=g,this.fetchRecords=function(){c.currentRecord={},this.editMode=!1},this.saveRecord=function(){var a=c.currentRecord;if(a.id||a.cid){var d=h(a);c.records.splice(d,1,a)}else a.cid=-b.floor(1e4*b.random()),a[c.parent]={id:c.refId},c.records.push(a);this.fetchRecords()},this.deleteRecord=function(a){var b=h(a);c.records.splice(b,1)},this.editRecord=function(b){c.currentRecord=a.copy(b),this.editMode=!0},this.createRecord=function(){this.editMode=!0,c.currentRecord={}}}function n(a,b,c,d,f,g){l.call(this,a,b,c,d);var i=e.all(g),j=e.one(f,a.refId).all(c);a.records=j.getList().$object;var k=this;this.fetchRecords=function(){return j.getList().then(function(b){return a.records=b,b})},this.deleteRecord=function(a){return a.remove().then(this.fetchRecords)},this.showList=function(){var b=h.createSelectionModal(a.displayName,i.getList(),a.records);b.result.then(function(){k.fetchRecords()},function(){k.fetchRecords()})},this.globalActions=[{name:"select",displayName:"Select",icon:"check",fn:function(){k.showList()},show:function(){return!k.editMode&&a.records}}],this.recordActions={"delete":{displayName:"Delete",icon:"minus",fn:function(a){k.deleteRecord(a)},show:function(){return!k.readOnly}}}}this.extendController=function(a){k.call(a.ctrl,a.scope,a.model,a.url,a.name,a.displayName)},this.extendCompChildCtrl=function(a){m.call(a.ctrl,a.scope,a.model,a.name,a.displayName,a.parent)},this.extendAggChildCtrl=function(a){n.call(a.ctrl,a.scope,a.model,a.name,a.displayName,a.parentUrl,a.listUrl)}}]),e.service("modalService",["$modal","CrudTemplatesDir",function(a,b){this.createSelectionModal=function(c,d,e){return a.open({animation:!0,templateUrl:b+"modal.tpl.html",controller:"modalCtrl",resolve:{name:function(){return c},items:function(){return d},currentItems:function(){return e}}})}}])}(window.angular,window.Math),angular.module("ngCrud").run(["$templateCache",function(a){"use strict";a.put("src/crud/templates/crud.tpl.html",'<toolbar name="name" display-name="displayName" actions="ctrl.globalActions"></toolbar><alert ng-repeat="alert in alerts" type="{{alert.type}}" close="ctrl.closeAlert($index)">{{alert.msg}}</alert><div ng-if="!ctrl.editMode"><div ng-if="ctrl.asGallery"><gallery fields="model.fields" records="records" actions="ctrl.recordActions"></gallery></div><div ng-if="!ctrl.asGallery"><list-records fields="model.fields" records="records" actions="ctrl.recordActions"></list-records></div><div class="text-center"><pagination ng-if="ctrl.numPages > 1" num-pages="ctrl.numPages" total-items="ctrl.totalItems" ng-model="ctrl.currentPage" ng-change="ctrl.pageChanged()" items-per-page="ctrl.itemsPerPage" max-size="ctrl.maxSize" class="pagination-md" boundary-links="true" rotate="false"></pagination></div></div><div ng-if="ctrl.editMode"><div class="well"><crud-form name="name" fields="model.fields" record="currentRecord"></crud-form></div><div id="childs" ng-if="model.childs"><ul class="nav nav-tabs"><li ng-repeat="child in model.childs" role="presentation" ng-class="{active: tab === child.name}" ng-if="child.owned || currentRecord.id"><a href ng-click="ctrl.changeTab(child.name)">{{child.displayName}}</a></li></ul><div ng-repeat="child in model.childs" ng-if="tab === child.name && (child.owned || currentRecord.id)"><div child-controller></div></div></div></div>'),a.put("src/crud/templates/datepicker.tpl.html",'<p class="input-group"><input type="text" id="{{model.name}}" name="{{model.name}}" class="form-control" ng-model="value" ng-required="model.required" datepicker-popup is-open="opened" readonly> <span class="input-group-btn"><button type="button" id="{{model.name}}-datepicker" class="btn btn-default" ng-click="open($event)"><span class="glyphicon glyphicon-calendar"></span></button></span></p>'),a.put("src/crud/templates/form.tpl.html",'<form novalidate name="form" id="{{name}}-form" role="form"><fieldset><input id="id" class="form-control" type="hidden" ng-model="record.id"><div class="form-group col-md-12" ng-repeat="column in fields" ng-switch="column.type" ng-class="{\'has-success\': form[column.name].$valid && form[column.name].$dirty, \'has-error\': form[column.name].$invalid && form[column.name].$dirty}"><label for="{{column.name}}" class="col-md-2 control-label">{{column.displayName}}</label><div class="col-md-10"><input ng-switch-when="String" id="{{column.name}}" name="{{column.name}}" class="form-control" type="text" ng-model="record[column.name]" ng-required="column.required"> <input ng-switch-when="Currency" id="{{column.name}}" name="{{column.name}}" class="form-control" type="number" ng-model="record[column.name]" ng-required="column.required"> <input ng-switch-when="Integer" id="{{column.name}}" name="{{column.name}}" class="form-control" type="number" ng-model="record[column.name]" ng-required="column.required"> <input ng-switch-when="Long" id="{{column.name}}" name="{{column.name}}" class="form-control" type="number" ng-model="record[column.name]" ng-required="column.required"> <input ng-switch-when="Boolean" id="{{column.name}}" name="{{column.name}}" ng-checked="record[column.name]" type="checkbox" ng-model="record[column.name]" ng-required="column.required && record[column.name].$isEmpty"> <input ng-switch-when="Computed" id="{{column.name}}" name="{{column.name}}" class="form-control" type="text" ng-value="column.fn(record)" readonly> <input ng-switch-when="Image" id="{{column.name}}" name="{{column.name}}" class="form-control" type="url" ng-model="record[column.name]" ng-required="column.required"><select ng-switch-when="Reference" id="{{column.name}}" name="{{column.name}}" class="form-control" ng-options="rc.name for rc in column.options track by rc.id" ng-model="record[column.name]"></select><date-picker ng-switch-when="Date" value="record[column.name]" model="column"></date-picker></div></div></fieldset></form>'),a.put("src/crud/templates/gallery.tpl.html",'<div class="col-sm-12"><div ng-repeat="record in records"><div class="col-md-4 col-sm-6 col-lg-3 well"><div class="col-md-12"><div class="img-thumbnail" ng-class="{\'col-sm-4\': !$first}" ng-repeat="(key, column) in fields| filter: {type: \'Image\'}" id="{{$parent.$index}}-{{column.name}}" ng-if="record[column.name]"><a ng-href="{{record[column.name]}}" target="_blank"><img class="img-responsive" style="height: 20vmax" ng-src="{{record[column.name]}}" alt="{{record[column.name]}}"></a></div></div><div class="caption"><div ng-repeat="(key, column) in fields| filter: {type: \'!Image\'}" ng-switch="column.type" id="{{$parent.$index}}-{{column.name}}"><p ng-switch-when="Computed"><strong>{{column.displayName}}:</strong> {{column.fn(record)}}</p><p ng-switch-when="Date"><strong>{{column.displayName}}:</strong> {{record[column.name]| date}}</p><p ng-switch-when="Reference"><strong>{{column.displayName}}:</strong> {{record[column.name].name}}</p><p ng-switch-when="Boolean"><strong>{{column.displayName}}:</strong> <span ng-if="record[column.name] !== undefined" class="glyphicon" ng-class="{\'glyphicon-check\': record[column.name], \'glyphicon-unchecked\': !record[column.name]}"></span></p><p ng-switch-when="String"><strong>{{column.displayName}}:</strong> {{record[column.name]}}</p><p ng-switch-when="Currency"><strong>{{column.displayName}}:</strong> {{record[column.name] | currency}}</p><p ng-switch-default><strong>{{column.displayName}}:</strong> {{record[column.name]}}</p></div></div><p ng-if="actions" class="text-center"><button ng-repeat="(key, action) in actions" id="{{$parent.$index}}-{{key}}-btn" class="btn btn-default btn-sm" ng-class="action.class" ng-show="action.show(record)" ng-click="action.fn(record)"><span class="glyphicon glyphicon-{{action.icon}}"></span> {{action.displayName}}</button></p></div></div></div>'),a.put("src/crud/templates/list.tpl.html",'<div><table class="table table-striped table-bordered"><thead><tr><th ng-if="checklist" id="check-all"><input type="checkbox" ng-click="checkAll()"></th><th ng-repeat="column in fields">{{column.displayName}}</th><th ng-if="actions">Actions</th></tr></thead><tbody><tr ng-repeat="record in records"><td ng-if="checklist" id="{{$index}}-selected"><input type="checkbox" ng-model="record.selected"></td><td ng-repeat="column in fields" ng-switch="column.type" id="{{$parent.$index}}-{{column.name}}"><div ng-switch-when="Computed">{{column.fn(record)}}</div><div ng-switch-when="Currency">{{record[column.name] | currency}}</div><div ng-switch-when="Date">{{record[column.name]| date}}</div><div ng-switch-when="Reference">{{record[column.name].name}}</div><div ng-switch-when="Boolean"><span ng-if="record[column.name] != undefined" class="glyphicon" ng-class="{\'glyphicon-check\': record[column.name], \'glyphicon-unchecked\': !record[column.name]}"></span></div><div ng-switch-when="Image"><a ng-href="{{record[column.name]}}">URL</a></div><div ng-switch-when="String">{{record[column.name]}}</div><div ng-switch-default>{{record[column.name]}}</div></td><td ng-if="actions"><button ng-repeat="(key, action) in actions" id="{{$parent.$index}}-{{key}}-btn" class="btn btn-default btn-sm" ng-class="action.class" ng-show="action.show(record)" ng-click="action.fn(record)"><span class="glyphicon glyphicon-{{action.icon}}"></span> {{action.displayName}}</button></td></tr></tbody></table></div>'),a.put("src/crud/templates/modal.tpl.html",'<div class="modal-header"><h3 class="modal-title">{{name}}</h3></div><div class="modal-body"><list-records fields="fields" records="items" actions="recordActions"></list-records></div><div class="modal-footer"><button class="btn btn-default btn-sm" ng-click="ok()"><span class="glyphicon glyphicon-ok"></span> OK</button> <button class="btn btn-default btn-sm" ng-click="cancel()"><span class="glyphicon glyphicon-remove"></span> Cancel</button></div>'),a.put("src/crud/templates/search.tpl.html",'<form novalidate name="form" id="{{name}}-form" role="form" ng-submit="submitFn()" class="form-horizontal"><legend>Search</legend><fieldset><div class="form-group col-md-12" ng-repeat="column in fields|filter: {searchable: true}" ng-switch="column.type" ng-class="{\'has-success\': form[column.name].$valid && form[column.name].$dirty, \'has-error\': form[column.name].$invalid && form[column.name].$dirty}"><label for="{{column.name}}-search" class="col-md-2 control-label">{{column.displayName}}</label><div class="col-md-10"><input ng-switch-when="String" id="{{column.name}}-search" name="{{column.name}}" class="form-control" type="text" ng-model="record[column.name]" ng-required="column.required"> <input ng-switch-when="Integer" id="{{column.name}}-search" name="{{column.name}}" class="form-control" type="number" ng-model="record[column.name]" ng-required="column.required"> <input ng-switch-when="Long" id="{{column.name}}-search" name="{{column.name}}" class="form-control" type="number" ng-model="record[column.name]" ng-required="column.required"> <input ng-switch-when="Boolean" id="{{column.name}}-search" name="{{column.name}}" type="checkbox" ng-model="record[column.name]" ng-checked="record[column.name]" ng-required="column.required && record[column.name].$isEmpty"> <input ng-switch-when="Computed" id="{{column.name}}-search" name="{{column.name}}" class="form-control" type="text" ng-value="column.fn(record)" readonly><select ng-switch-when="Reference" id="{{column.name}}-search" name="{{column.name}}" class="form-control" ng-options="rc.name for rc in column.options track by rc.id" ng-model="record[column.name]"></select><date-picker ng-switch-when="Date" value="record[column.name]" model="column"></date-picker></div></div><div class="form-group col-md-12"><input type="submit" value="Search" class="form-control btn btn-primary"></div></fieldset></form>'),a.put("src/crud/templates/toolbar.tpl.html",'<nav class="navbar navbar-default" role="navigation"><div class="container-fluid"><div class="navbar-header"><button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#{{name}}-navbar"><span class="sr-only">Toggle navigation</span> <span class="icon-bar"></span> <span class="icon-bar"></span> <span class="icon-bar"></span></button> <a class="navbar-brand">{{displayName}}</a></div><div class="collapse navbar-collapse" id="{{name}}-navbar"><button ng-repeat="(key, action) in actions" id="{{key}}-{{name}}" class="btn btn-default navbar-btn" ng-click="action.fn()"><span class="glyphicon glyphicon-{{action.icon}}"></span> {{action.displayName}}</button></div></div></nav>')}]);